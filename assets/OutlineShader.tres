[gd_resource type="Shader" format=2]

[resource]
code = "shader_type canvas_item;

uniform float outline_width = 2.0;
uniform vec4 outline_color: hint_color;
uniform sampler2D noise : hint_black;

void fragment() {
    vec4 col = texture(TEXTURE, UV);
    vec2 ps = TEXTURE_PIXEL_SIZE;
    float a;
    float maxa = col.a;
    float mina = col.a;
    
    float ow = outline_width + texture(noise, UV + vec2(0.0, -TIME)).r * 20.0;
    
    a = texture(TEXTURE, UV + vec2(0.0, -ow) * ps).a;
    maxa = max(a, maxa);
    mina = min(a, mina);
    
    a = texture(TEXTURE, UV + vec2(0.0, ow) * ps).a;
    maxa = max(a, maxa);
    mina = min(a, mina);
    
    a = texture(TEXTURE, UV + vec2(-ow, 0.0) * ps).a;
    maxa = max(a, maxa);
    mina = min(a, mina);
    
    a = texture(TEXTURE, UV + vec2(ow, 0.0) * ps).a;
    maxa = max(a, maxa);
    mina = min(a, mina);
    
    COLOR = mix(col, outline_color, maxa - mina);
}"
